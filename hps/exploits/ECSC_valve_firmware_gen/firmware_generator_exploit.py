import tlv8

from firmware_utils import *

extractor = open("a.out", "rb").read()
orig_firmware = open("test.bin", "rb").read()
data = open("test_data2.zip", "rb").read()

decoded = tlv8.decode(orig_firmware, structure).data
decoded[2] = tlv8.Entry(3, extractor)
#decoded[5] = tlv8.Entry(6, data)
target = open("test_exploit.bin", "wb")

target.write(tlv8.encode(decoded))
target.close()